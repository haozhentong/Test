<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>alloyFinger 练习</title>
  <style>
  * {margin: 0;padding: 0;}
  .imgBox {
    text-align: center;
    margin-bottom: 10px;
    border-bottom: 1px solid #000;
  }
  img {
    width: 160px;
  }
  .title {
    text-align: center;
  }
  </style>
</head>
<body>
  <div class="example">
    <div class="title"> tap </div>
    <div class="imgBox tapBox">
      <img src="http://alloyteam.github.io/AlloyFinger/asset/test.png" alt="">
    </div>

    <div class="title"> pinch </div>
    <div class="imgBox">
      <img id="pinchImage" src="http://alloyteam.github.io/AlloyFinger/asset/test.png" alt="">
    </div>

    <div class="title"> rotate </div>
    <div class="imgBox">
      <img id="rotateImage" src="http://alloyteam.github.io/AlloyFinger/asset/test.png" alt="">
    </div>

    <div class="title"> pinch + rotate </div>
    <div class="imgBox">
      <img id="pinchRotateImage" src="http://alloyteam.github.io/AlloyFinger/asset/test.png" alt="">
    </div>

  </div>
  <script src="./vconsole.min.js"></script>
  <script src="./alloy_finger.js"></script>
  <script>
  new VConsole();
  // rotate(0deg) translateX(xPx)
  function getNumberByTransformAttribute(str) {
    const initArr = str.split(/[\(\)]/);
    return parseInt(initArr[1]);
  }
  new AlloyFinger(
    document.querySelector('.tapBox'),
    {
      tap: function() {
        console.log('tap');
      },
      doubleTap: function() {
        console.log('doubleTap');
      }
    }
  )
  // codingdream
  // 192.168.31.98 冒号(:) 端口号(8080)
  const pinchImage = document
  .getElementById('pinchImage');
  new AlloyFinger(
    pinchImage,
    {
      pinch: function(evt) {
        pinchImage.style.transform = `scale(${evt.zoom})`;
      }
    }
  )
  // rotate
  const rotateImage = document.getElementById('rotateImage');
  new AlloyFinger(
    rotateImage,
    {
      rotate: function(evt) {
        console.log(evt.angle);
        // rotate : 2 2deg
        // rotate : 4 6deg
        // rotate : 5 11deg
        const rotateStr = rotateImage.style.transform 
        || 'rotate(0deg)';
        // console.log(rotateStr); // rotate(89deg)
        const rotateStrSplit = rotateStr.split(/[\(\)]/);
        let deg = parseInt(rotateStrSplit[1]);
        rotateImage.style.transform = `rotate(${evt.angle + deg}deg)`;
      }
    }
  )
  // pinchRotate 
  const pinchRotateImage = document
  .getElementById('pinchRotateImage')
  new AlloyFinger(
    pinchRotateImage,
    {
      pinch: function(evt) {
        const initStr = pinchRotateImage.style
        .transform || 'rotate(0)';
        // `rotate(0deg) scale(${evt.zoom})`
        const initStyleArr = initStr.split(' ');
        pinchRotateImage.style.transform = 
        `${initStyleArr[0]} scale(${evt.zoom})`;
      },
      rotate: function(evt) {
        const initStr = pinchRotateImage.style
        .transform || 'rotate(0)';
        // `rotate(0deg) scale(${evt.zoom})`
        const initStyleArr = initStr.split(' ');
        const deg = 
        getNumberByTransformAttribute(initStyleArr[0]);
        pinchRotateImage.style.transform = 
        `rotate(${deg + evt.angle}deg) ${initStyleArr[1]}`;
      }
    }
  )
  </script>
</body>
</html>